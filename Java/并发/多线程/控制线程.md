## æ§åˆ¶çº¿ç¨‹

> Javaæä¾›äº†ä¸€äº›ä¾¿æ·å·¥å…·æ¥å¾ˆå¥½çš„æ§åˆ¶çº¿ç¨‹

#### joinçº¿ç¨‹

- join()æ˜¯Threadæä¾›äº†è®©ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®Œæˆçš„æ–¹æ³•
- å½“æŸä¸ªçº¿ç¨‹æ‰§è¡Œæµä¸­è°ƒç”¨å…¶ä»–çº¿ç¨‹çš„join()æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°è¢«joinæ–¹æ³•åŠ å…¥çš„joinçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¸ºæ­¢ã€‚

- ä»£ç å®æ“

  ```java
  public class JoinThread extends Thread {
  
      public JoinThread(String name) {
          super(name);
      }
  
      @Override
      public void run() {
          for (int i = 0; i < 100; i++) {
              System.out.println(this.getName() + " == " + i);
          }
      }
  }
  
   public static void main(String[] args) throws InterruptedException {
          new JoinThread("çº¿ç¨‹1").start();
  
          for (int i = 0; i < 100; i++) {
              if (i == 20) {
                  JoinThread joinThread = new JoinThread("è¢«Joinçº¿ç¨‹");
                  joinThread.start();
                  // ä¸»çº¿ç¨‹ğŸ‰ï¸ç­‰åˆ° joinThreadæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œåœ¨æ‰§è¡Œä¹‹åçš„ä»£ç 
                  joinThread.join();
              }
  
              System.out.println(" i == " + i);
          }
      }
  }
  
  ```

###### joinæ–¹æ³•çš„é‡è½½

- join()ï¼šç­‰å¾…è¢«joinçº¿ç¨‹æ‰§è¡Œå®Œæ¯•
- join(long millis):ç­‰å¾…è¢«joinçº¿ç¨‹çš„æ—¶é—´æœ€é•¿ä¸ºmillisæ¯«ç§’ã€‚å¦‚æœæ²¡åœ¨millisæ¯«ç§’å†…è¢«joinçº¿ç¨‹è¿˜æ²¡æ‰§è¡Œå€Ÿå®¿ï¼Œé‚£ä¹ˆå°±ä¸ç­‰å¾…äº†ã€‚
- join(long millis,int nanos):ç­‰å¾…è¢«joinçº¿ç¨‹çš„æ—¶é—´æœ€é•¿ä¸ºmillisæ¯«ç§’+nanoså¾®æ¯«ç§’ã€‚

#### åå°çº¿ç¨‹

> æœ‰ä¸€ç§çº¿ç¨‹ï¼Œæ˜¯è¿è¡Œåœ¨åå°ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹æä¾›æœåŠ¡ï¼Œ
>
> JVMçš„åƒåœ¾å›æ”¶çº¿ç¨‹å°±æ˜¯å…¸å‹çš„åå°çº¿ç¨‹ã€‚

- åå°çº¿ç¨‹çš„ç‰¹æ€§ï¼šå¦‚æœæ‰€æœ‰å‰å°çº¿ç¨‹éƒ½æ­»äº¡ï¼Œé‚£ä¹ˆåå°çº¿ç¨‹è‡ªåŠ¨æ­»äº¡ã€‚
- è°ƒç”¨Threadçš„setDeamon(true)æ–¹æ³•ä¼šå°†æŒ‡å®šçº¿ç¨‹è®¾ç½®æˆåå°çº¿ç¨‹ã€‚

- ä»£ç å®æ“

  ```java
  public class DaemonThread extends Thread {
      @Override
      public void run() {
          for (int i = 0; i < 100; i++) {
              System.out.println("i == " + i);
          }
      }
  }
  
  public class DaemonMain {
  
      public static void main(String[] args) {
          //é¦–å…ˆåˆ›å»ºä¸€ä¸ªçº¿ç¨‹
          DaemonThread daemonThread = new DaemonThread();
          //å°†è¯¥çº¿ç¨‹è®¾ç½®ä¸ºåå°çº¿ç¨‹
          daemonThread.setDaemon(true);
          //å¼€å¯åå°çº¿ç¨‹
          daemonThread.start();
  
          for (int i = 0; i < 100; i++) {
              System.out.println(Thread.currentThread().getName() + "===" + i);
          }
        // å½“å‰å°çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå°±ä¼šé€€å‡ºé‚£ä¹ˆåå°çº¿ç¨‹ä¹Ÿå°†é€€å‡ºã€‚
      }
  }
  ```

- isDaemon()åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºåå°çº¿ç¨‹
- å‰å°çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹é»˜è®¤æ˜¯å‰å°çº¿ç¨‹ï¼Œåå°çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹é»˜è®¤å°±æ˜¯åå°çº¿ç¨‹ã€‚

###### æ³¨æ„

å‰å°çº¿ç¨‹éƒ½æ­»äº¡åï¼ŒJVMä¼šé€šçŸ¥åå°çº¿ç¨‹ï¼Œä»æ¥å—åˆ°æŒ‡ä»¤åˆ°ä½œå‡ºè°ƒæ•´éœ€è¦ä¸€å®šæ—¶é—´ã€‚

åœ¨æŠŠä¸€ä¸ªçº¿ç¨‹è®¾ç½®ä¸ºåå°çº¿ç¨‹çš„æ—¶å€™ä¸€å®šè¦åœ¨çº¿ç¨‹å¯åŠ¨ä¹‹å‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ çš„ã€‚

#### çº¿ç¨‹ç¡çœ ï¼šsleep

> å¦‚æœéœ€è¦å°†å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨sleep()æ–¹æ³•

###### sleep()æ–¹æ³•çš„ä¸¤ç§é‡è½½

- sleep(long millis):è®©å½“å‰æ‰§è¡Œçš„çº¿ç¨‹æš‚åœmillisæ¯«ç§’ï¼Œå¹¶åŒæ—¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¯¥æ–¹æ³•æ”¶ç³»ç»Ÿè®¡æ—¶å™¨å’Œçº¿ç¨‹è°ƒåº¦å™¨çš„ç²¾åº¦ä¸å‡†åº¦å½±å“.
- sleep(long millis,int nonos):è¿è¡Œçº¿ç¨‹æš‚åœmillisæ¯«ç§’â•nonuså¾®æ¯«ç§’ã€‚ï¼ˆå¾ˆå°‘ç”¨ï¼‰
- ä¸€èˆ¬sleep()æ–¹æ³•ç”¨æ¥æš‚åœç¨‹åºçš„æ‰§è¡Œã€‚

#### çº¿ç¨‹è®©æ­¥ï¼šyield

> yieldå’Œsleepæ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ï¼Œéƒ½æ˜¯Threadçš„é™æ€æ–¹æ³•
>
> yieldæ˜¯æš‚åœè¿è¡Œçš„çº¿ç¨‹ï¼Œå®ƒä¸ä¼šå µå¡çº¿ç¨‹ï¼Œåªæ˜¯è®©è¯¥çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚

- å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†yieldæ–¹æ³•ä¹‹åï¼Œåªæœ‰ä¼˜å…ˆçº§ä¸å½“å‰çº¿ç¨‹ç›¸åŒï¼Œæˆ–è€…ä¼˜å…ˆçº§æ¯”å½“å‰çº¿ç¨‹æ›´é«˜çš„å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ‰èƒ½è·å¾—æ‰§è¡Œæœºä¼šã€‚

- ä»£ç å®æ“

  ```java
  public class YieldThread extends Thread {
  
      public YieldThread(String name) {
          super(name);
      }
  
      @Override
      public void run() {
          for (int i = 0; i < 100; i++) {
              System.out.println(getName() + " " + i);
              if (i == 20) {
                  // æ²¡æœ‰åƒsleepé‚£æ · æŠ›å‡ºå¼‚å¸¸
                  yield();
              }
          }
      }
  }
  
  public class YieldThreadMain {
      public static void main(String[] args) {
          YieldThread yieldThreadMain = new YieldThread("é«˜çº§ == çº¿ç¨‹");
          //è®¾ç½®æˆæœ€é«˜ç­‰çº§
         // yieldThreadMain.setPriority(Thread.MAX_PRIORITY);
          yieldThreadMain.start();
  
          YieldThread yieldThread = new YieldThread("ä½çº§ == çº¿ç¨‹");
         // yieldThread.setPriority(Thread.MIN_PRIORITY);
          yieldThread.start();
  
      }
  }
  ```

###### yieldå’Œsleepæ–¹æ³•çš„åŒºåˆ«

- yieldè®©çº¿ç¨‹æš‚åœåç›´æ¥å˜æˆäº†å°±ç»ªçŠ¶æ€ï¼›è€Œsleepéœ€è¦ç»è¿‡é˜»å¡çš„çŠ¶æ€ã€‚
- sleepæ–¹æ³•å£°æ˜æŠ›å‡ºäº†InterruptedExceptionå¼‚å¸¸ï¼Œè¦ä¹ˆå¤„ç†è¿™ä¸ªå¼‚å¸¸ è¦ä¹ˆæ˜¾ç¤ºå£°æ˜æŠ›å‡ºå¼‚å¸¸ã€‚yieldæ–¹æ³•æ²¡æœ‰åœ¨å£°æ˜çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ã€‚
- sleepæš‚åœçº¿ç¨‹åï¼Œä¼šç»™å…¶ä»–ä»»ä½•å°±ç»ªçŠ¶æ€çº¿ç¨‹çš„æ‰§è¡Œæœºä¼šï¼›è€Œyieldæš‚åœçº¿ç¨‹åï¼Œæ¯”ä»–ä¼˜å…ˆçº§ç›¸åŒæˆ–è€…å¤§çš„æ‰æœ‰è¿›å…¥å¯æ‰§è¡ŒçŠ¶æ€çš„ã€‚
- sleepæ–¹æ³•æ¯”yieldæ–¹æ³•æœ‰æ›´å¥½çš„å¯ç§»æ¤æ€§ï¼Œé€šå¸¸ä¸å»ºè®®ä½¿ç”¨yieldæ–¹æ³•æ¥æ§åˆ¶å¹¶å‘çº¿ç¨‹çš„æ‰§è¡Œã€‚

#### æ”¹å˜çº¿ç¨‹çš„ä¼˜å…ˆçº§

> æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹è·å¾—æ‰§è¡Œçš„å°±ä¼šå°±å¤šäº›ï¼Œç›¸æ¯”ä¼˜å…ˆçº§é«˜çš„ï¼Œä¼˜å…ˆçº§ä½è·å–åˆ°æ‰§è¡Œçš„æœºä¼šå°±å°‘äº›ã€‚
>
> çº¿ç¨‹çš„ä¼˜å…ˆçº§ä¸åˆ›å»ºå®ƒçš„çˆ¶çº¿ç¨‹ä¼˜å…ˆçº§ç›¸åŒï¼Œmainçº¿ç¨‹æ˜¯æ™®é€šçº§åˆ«ï¼Œé‚£ä¹ˆåˆ›å»ºçš„å­çº¿ç¨‹å°±æ˜¯æ™®é€šçº§åˆ«ã€‚(è¿™é‡Œmainçº¿ç¨‹çš„å­çº¿ç¨‹å°±æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­å¼€å¯äº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹)

###### æ“ä½œä¼˜å…ˆçº§çš„æ–¹æ³•

- setPriority(int newPriority):è®¾ç½®å½“å‰çº¿ç¨‹å¯¹è±¡çš„ä¼˜å…ˆçº§ï¼Œå…¶ä¸­newPriorityæ˜¯ 1åˆ°10ä¹‹é—´çš„
  - MAX_PRIORITY :10
  - MIN_PRIORITY:1
  - NORM_PRIORITY:5
- getPriority():è¿”å›å½“å‰çº¿ç¨‹çš„ä¼˜å…ˆçº§

- ä»£ç å®æ“

  ```java
  public class PriorityThread extends Thread {
  
      public PriorityThread(String name) {
          super(name);
      }
  
      @Override
      public void run() {
          for (int i = 0; i < 100; i++) {
              System.out.println(getName() +
                      ",å®ƒçš„ä¼˜å…ˆçº§æ˜¯" + getPriority() +
                      "å¾ªç¯å˜é‡æ˜¯" + i);
          }
      }
  }
  
  public class PriorityThreadMain {
      public static void main(String[] args) {
          //æ”¹å˜ä¸»çº¿ç¨‹çš„ä¼˜å…ˆçº§
          Thread.currentThread().setPriority(6);
  
          for (int i = 0; i < 30; i++) {
              if (i == 10) {
                  PriorityThread low = new PriorityThread("ä½ä¼˜å…ˆçº§");
                  low.start();
                  System.out.println("low åˆ›å»ºä¹‹å¤„çš„ä¼˜å…ˆçº§" + low.getPriority());
                  low.setPriority(Thread.MIN_PRIORITY);
              }
  
              if (i == 20) {
                  PriorityThread high = new PriorityThread("é«˜ä¼˜å…ˆçº§");
                  high.start();
                  System.out.println("high åˆ›å»ºä¹‹åˆçš„ä¼˜å…ˆçº§" + high.getPriority());
                  high.setPriority(Thread.MAX_PRIORITY);
              }
          }
      }
  }
  
  // èµ·åˆæˆ‘ä»¬åˆ›å»ºlowä¸highçš„ä¼˜å…ˆçº§ä¸mainç›¸åŒ éƒ½æ˜¯6
  //æ‰“å°logæˆ‘ä»¬å‘ç° é«˜ä¼˜å…ˆçº§è·å–åˆ°æ‰§è¡Œæƒæœºä¼šå¤šäº›
  ```

  