## apply()和commit()方法有什么区别

###### apply

- apply操作之后没有返回值
- apply是将修改数据原子提交到内存中，而后有调用apply的函数将会直接覆盖前面的内存数据。异步提交到硬件磁盘中。

###### commit

- commit操作之后有返回值（boolean），表示是否修改成功。
- commit是同步提交到硬件磁盘中，多个commit的时候，会等待正在处理的commit保存到磁盘后，在进行提交，从而降低了效率。



###### commit和apply方法的区别

- commit向磁盘写入的时候是同步操作的，会有结果的返回。同步的保证使用的Countdownlatch；即使是同步操作但是不保证王磁盘写入时是发生在当前线程中
- apply()方法向磁盘写入的时候是一部操作发生在QueuedWord中，内部维护了一个线程去执行磁盘写入的操作

###### 阻塞主线程

- commit只要在主线程中调用都会阻塞主线程的。
- apply方法磁盘写入操作虽然是异步操作的。但是当组件状态发生转换的时候会把QueuedWork中未完成的磁盘写入操作放在主线程中，如果比较耗时的话会发生ANR

###### 跨进程

- 跨进程操作需要借助Android平台常规的IPC手段。

