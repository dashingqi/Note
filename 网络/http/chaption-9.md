## HTTP的报文的样子

在HTTP的工作过程中，TCP/IP协议负责了底层具体的传输工作，HTTP协议就不用关心这方面；

那么HTTP的核心部分是什么呢？--- 就是它传输的【报文内容】

#### 报文结构

HTTP报文分为请求报文和响应报文，这两种报文结构基本是相同的，分为三部分组成；

- 启始行：描述请求或者响应的基本信息；
- 头部字端：使用key-value形式说明报文；
- 消息正文：实际传输的数据，不一定是纯文本可以是图片或者视频等二进制数据；

其中前两部分我们称为【请求头】或者【响应头】（header）后面的部分我们称之为【实体】（body）

在HTTP协议中明确规定了，必须有header，可以没有body，并且在header之后要有一个空行，也就是【CRLF】,十六进制是【0D0A】

画个图描述下

<img src="/Users/zhangqi61/Downloads/DQFile/HTTP报文结构（请求报文:响应报文）.png" alt="HTTP报文结构（请求报文:响应报文）" style="zoom:150%;" />

拿我们之前Wireshark 抓包数据看下

![HTTP请求报文](https://raw.githubusercontent.com/dashingqi/DQPicBeg/main/202205211729350.PNG)

###### 请求行

GET / HTTP/1.1 第一行就是我们的请求行

分为三部分

- 请求方法：【GET】表示对资源的操作；
- 请求目标： 【/】通常是一个URI，标记了请求方法要操作的资源；
- 版本号: 【HTTP/1.1】表示报文使用HTTP协议的版本号，版本号就约束了双方要使用一致

上述三部分每部分之间使用【空格】（space）分割，最后用【换行】（CRLF）表示结束

<img src="/Users/zhangqi61/Downloads/DQFile/请求行结构.png" alt="请求行结构" style="zoom:150%;" />

看完了请求行我们看下响应报文中的响应行-【状态行】

在看状态行之前我们先看下响应报文的抓包

<img src="/tmp/VMwareDnD/815cdc82/HTTP响应报文.PNG" alt="HTTP响应报文" style="zoom:150%;" />

###### 状态行

HTTP/1.1 200 OK

分为三部分

- 版本号: 【HTTP/1.1】使用的HTTP协议版本
- 状态码: 【200】三位数字，用代码标识处理的结果
- 原因: 【OK】：数字状态码的补充，帮助人理解原因

<img src="/Users/zhangqi61/Downloads/DQFile/响应的状态行.png" alt="响应的状态行" style="zoom:150%;" />



#### 头部字段

请求头/响应头 = 请求行/状态行 + 头部字段的集合

头部字段是key-value形式，key和value之间用 ":"分割，最后用CRLF换行表示

在HTTP中头字段非常零活，主要体现在开发者可以自己定义头字段信息

###### 注意

- 字段名称不区分大小写
- 字段名称不能出现空格，可以使用【-】，但是不能使用【_】
- 字段名称后面必须紧接着【:】,不能有空格【:】后的值前可以有多个空格
- 字段排放顺序不影响其作用与语义
- 字段原则上不能重复，除非字段本身的语义允许，【Set-Cookie】

##### 常用头字段

###### 通用字段

在请求头和响应头中都可以出现

###### 请求字段

仅能出现在请求头中；进一步说明请求信息

- HOST属于请求字段，仅能出现在请求头中，在HTTP/1.1规范中要求必须【出现的字段】，否则就是一个错误的字段；
  - 用于告知这个请求交由那个服务器处理；
- User-Agent属于请求字段，仅能出现在请求头中；
  - 使用一个字符串来描述发起HTTP请求的客户端

响应字段

仅能出现在响应头中；补充说明响应报文的信息

- Date是一个通用字段，通常出现在响应头中
  - 表示HTTP报文创建的时间
- Server是一个响应字段，只能出现在响应头中；
  - 用于告知正在提供Web服务的软件名称和版本号；
  - 是一个非必需出现的字段，因为该字段会把服务器信息暴露出去，如果改版本服务器出现Bug，就可以有机可乘了；
  - 或者出现这个字段时，value可以设置一些无用信息；

###### 实体字段

属于通用的字段，但是用来描述【body】的；

- Content-Length
  - 表示报文里body的长度



